<!-- Generator: Widdershins v4.0.1 -->

<h1 id="ln-markets-api">LN-Markets API v1.0.1</h1>

> Scroll down for code samples, example requests and responses. Select a language for code samples from the tabs above or the mobile navigation menu.

Trade derivatives on the **[Lightning Network](https://lightning.network/).**

Base URLs:

* <a href="https://api.lnmarkets.com">https://api.lnmarkets.com</a>

# Authentication

* API Key (cookieAuth)
    - Parameter Name: **session**, in: cookie. 

- HTTP Authentication, scheme: bearer 

<h1 id="ln-markets-api-lnurl">LNURL</h1>

Interactions with Lightning Network

## LNURL_authentificate

<a id="opIdLNURL_authentificate"></a>

`GET /lnurl/a`

*First request for LNURL where the wallet send the public key with the k1 and signature.*

Verify the public key with the signature and the k1 to create a account or connect into a existing account.

<h3 id="lnurl_authentificate-parameters">Parameters</h3>

|Name|In|Type|Required|Description|
|---|---|---|---|---|
|k1|query|string|true|Hex encoded 32 bytes of challenge which is going to be signed by user private key.|
|tag|query|string|true|LNURL type.|
|sig|query|string|true|Signature generated by the lightning wallet.|
|key|query|string|true|Public key of the lightning wallet.|
|hmac|query|string|true|HMAC signature used to secure LNURL.|
|t|query|string|false|Timestamp.|

#### Enumerated Values

|Parameter|Value|
|---|---|
|tag|login|

<h3 id="lnurl_authentificate-responses">Responses</h3>

|Status|Meaning|Description|Schema|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|Sucessfuly logged in.|None|
|400|[Bad Request](https://tools.ietf.org/html/rfc7231#section-6.5.1)|The request query and / or body does not fit the schema requirements. It can also be raised by parameters leading to unexpected behaviour / results.|None|

<aside class="success">
This operation does not require authentication
</aside>

## LNURL_authCreate

<a id="opIdLNURL_authCreate"></a>

`GET /lnurl/a/c`

*LNURL Auth creation.*

LNURL string used  used to create a account or connect to a existing account.

> Example responses

> 200 Response

```json
{
  "type": "object",
  "properties": {
    "lnurl": {
      "type": "string",
      "example": "lnurl1dp68gup69uhkcmmrv9kxsmmnwsarxvpsxqhkcmn4wfkz7cflw3skw0tvdankjm3xdvcn6venvgcrjenpx3nrwdtpxsur2vfsvdjk2dfkxe3kgceexymkgcmrxpjkgc3jvgmrqdnzvvurjwtr89jk2dp4vccrxvmrvvmxzdehxuejv6rdv93n6wpkv56rxcf4xqcxgwfsvsuxget9vymnqcfnv43rgwfjv5ex2cn9vyckgwtyvejrgc3excekyetpx43rvd3nxeskxvm9xqcxvwtpv5mq9uwr0k"
    }
  }
}
```

<h3 id="lnurl_authcreate-responses">Responses</h3>

|Status|Meaning|Description|Schema|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|Bech32 encoded string.|Inline|

<h3 id="lnurl_authcreate-responseschema">Response Schema</h3>

Status Code **200**

|Name|Type|Required|Restrictions|Description|
|---|---|---|---|---|
|» lnurl|string|false|none|none|

<aside class="success">
This operation does not require authentication
</aside>

## LNURL_Withdraw

<a id="opIdLNURL_Withdraw"></a>

`GET /lnurl/w`

*Third LNURL withdraw request.*

Use LNURL to withdraw from the user balance.

<h3 id="lnurl_withdraw-parameters">Parameters</h3>

|Name|In|Type|Required|Description|
|---|---|---|---|---|
|k1|query|string|true|Random hex string to identify the user Lightning Wallet.|
|pr|query|string|true|Bolt 11 invoice.|

<h3 id="lnurl_withdraw-responses">Responses</h3>

|Status|Meaning|Description|Schema|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|Sucessfuly withdrawn funds from channel.|None|
|400|[Bad Request](https://tools.ietf.org/html/rfc7231#section-6.5.1)|The request query and / or body does not fit the schema requirements. It can also be raised by parameters leading to unexpected behaviour / results.|None|
|401|[Unauthorized](https://tools.ietf.org/html/rfc7235#section-3.1)|The request query and / or body does not fit the schema requirements. It can also be raised by parameters leading to unexpected behaviour / results.|None|

<aside class="success">
This operation does not require authentication
</aside>

## LNURL_WithdrawRequest

<a id="opIdLNURL_WithdrawRequest"></a>

`GET /lnurl/w/r`

*Second LNURL withdraw request.*

Ask the Lightning wallet to create an invoice with amount and description.

<h3 id="lnurl_withdrawrequest-parameters">Parameters</h3>

|Name|In|Type|Required|Description|
|---|---|---|---|---|
|signature|query|string|true|HMAC payload signature.|
|n|query|string|true|Nonce.|
|expiry|query|integer(int32)|true|Timestamp when the LNURL is expired.|

> Example responses

> 200 Response

```json
{
  "type": "object",
  "properties": {
    "callback": {
      "type": "string",
      "example": "https://api.lnmarkets.com/lnurl/w"
    },
    "defaultDescription": {
      "type": "string",
      "example": "LN Markets withdraw"
    },
    "tag": {
      "type": "string",
      "example": "withdrawRequest"
    },
    "maxWithdrawable": {
      "type": "integer",
      "format": "int32",
      "example": 1000
    },
    "minWithdrawable": {
      "type": "integer",
      "format": "int32",
      "example": 1000
    },
    "k1": {
      "type": "string",
      "example": "31c92c1bd79d2ae5f96a153ceda105cb67888c61bfb76baa1d2505a6bf8a06ca"
    }
  }
}
```

<h3 id="lnurl_withdrawrequest-responses">Responses</h3>

|Status|Meaning|Description|Schema|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|LNURL withdraw invoice parameter.|Inline|
|400|[Bad Request](https://tools.ietf.org/html/rfc7231#section-6.5.1)|The request query and / or body does not fit the schema requirements. It can also be raised by parameters leading to unexpected behaviour / results.|None|

<h3 id="lnurl_withdrawrequest-responseschema">Response Schema</h3>

Status Code **200**

|Name|Type|Required|Restrictions|Description|
|---|---|---|---|---|
|» callback|string|false|none|none|
|» defaultDescription|string|false|none|none|
|» tag|string|false|none|none|
|» maxWithdrawable|integer(int32)|false|none|none|
|» minWithdrawable|integer(int32)|false|none|none|
|» k1|string|false|none|none|

<aside class="success">
This operation does not require authentication
</aside>

<h1 id="ln-markets-api-login">Login</h1>

Authentification processes

## Login_getCredentials

<a id="opIdLogin_getCredentials"></a>

`GET /login/credentials`

*Informations needed to create an account.*

Generates an invoice for future use in the account creation process.

> Example responses

> 200 Response

```json
{
  "type": "object",
  "properties": {
    "invoice": {
      "type": "string",
      "example": "lntb1u1p0jfxqcpp5ju9y2cur3v7nderx6u6ah7xj82lczem0pmmm4z5n2sn3de4qjqwqdz42pshjgr5dp5hxgrfdemx76trv5s8gmeqvdex2ct5v5s8jmm4wgsxzcmrda6kuapqdahzqnzwypxkzuntv468xcqzpgxqzz6sp53jz0ewjjwvnzkpl9pz8ar506z7dq3e4yw05pj9lulknhrwscncpq9qy9qsqzjvtdmnzptrq8avvynfdkswcts4ll8ffxxu02pgcg2ptyvz4xncsxrx3u32paw4806et6wan6tln60266zpd77a7usyv59jc83mnukqphdr5yx"
    },
    "expiry": {
      "type": "integer",
      "format": "int32",
      "example": 90
    }
  }
}
```

<h3 id="login_getcredentials-responses">Responses</h3>

|Status|Meaning|Description|Schema|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|Invoice successfuly generated.|Inline|

<h3 id="login_getcredentials-responseschema">Response Schema</h3>

Status Code **200**

|Name|Type|Required|Restrictions|Description|
|---|---|---|---|---|
|» invoice|string|false|none|none|
|» expiry|integer(int32)|false|none|none|

<aside class="success">
This operation does not require authentication
</aside>

## Login_registerCredentials

<a id="opIdLogin_registerCredentials"></a>

`PUT /login/credentials`

*Register a new account.*

Pay the invoice generated through a `/login/credentials` **GET** request and then use `paymentHash` to certify validity and finaly create the account.

> Body parameter

```json
{
  "type": "object",
  "required": [
    "paymentHash",
    "login",
    "password"
  ],
  "properties": {
    "paymentHash": {
      "type": "string",
      "minLength": 64,
      "maxLength": 64,
      "example": "b45dd2e30309aa708a73f0cfa0e38db5bbbbd16055087a692e0711365e7e08f5"
    },
    "login": {
      "type": "string",
      "pattern": "^\\S{6,32}$",
      "minLength": 6,
      "maxLength": 32,
      "example": "Test-login"
    },
    "password": {
      "type": "string",
      "format": "password",
      "pattern": "^(?=\\S)(?=.*\\d)(?=.*[a-z])(?=.*[A-Z]).\\S{7,63}",
      "minLength": 8,
      "maxLength": 64,
      "example": "Test-Password01"
    }
  },
  "additionalProperties": false
}
```

<h3 id="login_registercredentials-parameters">Parameters</h3>

|Name|In|Type|Required|Description|
|---|---|---|---|---|
|body|body|object|true|none|
|» paymentHash|body|string|true|none|
|» login|body|string|true|none|
|» password|body|string(password)|true|none|

> Example responses

> 200 Response

```json
{
  "type": "object",
  "properties": {
    "username": {
      "type": "string",
      "example": "Test-login"
    },
    "balance": {
      "type": "string",
      "example": "0"
    },
    "account_type": {
      "type": "string",
      "example": "credentials"
    }
  }
}
```

<h3 id="login_registercredentials-responses">Responses</h3>

|Status|Meaning|Description|Schema|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|User successfuly created and logged.|Inline|
|400|[Bad Request](https://tools.ietf.org/html/rfc7231#section-6.5.1)|The request query and / or body does not fit the schema requirements. It can also be raised by parameters leading to unexpected behaviour / results.|None|

<h3 id="login_registercredentials-responseschema">Response Schema</h3>

Status Code **200**

|Name|Type|Required|Restrictions|Description|
|---|---|---|---|---|
|» username|string|false|none|none|
|» balance|string|false|none|none|
|» account_type|string|false|none|none|

<aside class="success">
This operation does not require authentication
</aside>

## Login_loginCredentials

<a id="opIdLogin_loginCredentials"></a>

`POST /login/credentials`

*Log into an existing account.*

Use existing credentials to log into an account.

> Body parameter

```json
{
  "type": "object",
  "required": [
    "login",
    "password"
  ],
  "properties": {
    "login": {
      "type": "string",
      "example": "Test-login"
    },
    "password": {
      "type": "string",
      "format": "password",
      "example": "Password01"
    }
  },
  "additionalProperties": false
}
```

<h3 id="login_logincredentials-parameters">Parameters</h3>

|Name|In|Type|Required|Description|
|---|---|---|---|---|
|body|body|object|true|none|
|» login|body|string|true|none|
|» password|body|string(password)|true|none|

> Example responses

> 200 Response

```json
{
  "type": "object",
  "properties": {
    "username": {
      "type": "string",
      "example": "Test-login"
    },
    "balance": {
      "type": "string",
      "example": "0"
    },
    "account_type": {
      "type": "string",
      "example": "credentials"
    }
  }
}
```

<h3 id="login_logincredentials-responses">Responses</h3>

|Status|Meaning|Description|Schema|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|Successfuly logged into the account.|Inline|
|400|[Bad Request](https://tools.ietf.org/html/rfc7231#section-6.5.1)|The request query and / or body does not fit the schema requirements. It can also be raised by parameters leading to unexpected behaviour / results.|None|

<h3 id="login_logincredentials-responseschema">Response Schema</h3>

Status Code **200**

|Name|Type|Required|Restrictions|Description|
|---|---|---|---|---|
|» username|string|false|none|none|
|» balance|string|false|none|none|
|» account_type|string|false|none|none|

### Response Headers

|Status|Header|Type|Format|Description|
|---|---|---|---|---|
|200|Set-Cookie|string||none|

<aside class="success">
This operation does not require authentication
</aside>

## Login_loginJoule

<a id="opIdLogin_loginJoule"></a>

`POST /login/joule`

Use the browser extension [Joule](https://lightningjoule.com/) to authentificate user.

> Body parameter

```json
{
  "type": "object",
  "required": [
    "message",
    "signature",
    "alias"
  ],
  "properties": {
    "message": {
      "type": "string",
      "example": "Test-Joule"
    },
    "signature": {
      "type": "string",
      "example": "rd1nn7qbnibf58mzaknokqu6eciiqr64gahrzzxy3h8ybdygbun7s86zrms1dedqnh7t4gxz3esqmaqi9pkf85f48rexai7qztbdznfp"
    },
    "alias": {
      "type": "string",
      "example": "Test-node"
    }
  },
  "additionalProperties": false
}
```

<h3 id="login_loginjoule-parameters">Parameters</h3>

|Name|In|Type|Required|Description|
|---|---|---|---|---|
|body|body|object|true|none|
|» message|body|string|true|none|
|» signature|body|string|true|none|
|» alias|body|string|true|none|

> Example responses

> 200 Response

```json
{
  "type": "object",
  "properties": {
    "username": {
      "type": "string",
      "example": "Test-node"
    },
    "balance": {
      "type": "string",
      "example": "0"
    },
    "linkingpublickey": {
      "type": "string",
      "example": "02b21cc4667e2d5e14920013d187d2af8c3ccfd32a310f63c7767cf8564f126357"
    },
    "account_type": {
      "type": "string",
      "example": "joule"
    }
  }
}
```

<h3 id="login_loginjoule-responses">Responses</h3>

|Status|Meaning|Description|Schema|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|Sucessfuly logged user.|Inline|
|400|[Bad Request](https://tools.ietf.org/html/rfc7231#section-6.5.1)|The request query and / or body does not fit the schema requirements. It can also be raised by parameters leading to unexpected behaviour / results.|None|

<h3 id="login_loginjoule-responseschema">Response Schema</h3>

Status Code **200**

|Name|Type|Required|Restrictions|Description|
|---|---|---|---|---|
|» username|string|false|none|none|
|» balance|string|false|none|none|
|» linkingpublickey|string|false|none|none|
|» account_type|string|false|none|none|

### Response Headers

|Status|Header|Type|Format|Description|
|---|---|---|---|---|
|200|Set-Cookie|string||none|

<aside class="success">
This operation does not require authentication
</aside>

<h1 id="ln-markets-api-positions">Positions</h1>

Interactions with the market

## Position_getPositionList

<a id="opIdPosition_getPositionList"></a>

`GET /positions`

*Positions history. (Rework API Response - Object with Array of Objects)*

Retrieves either opened, closed or all positions.

<h3 id="position_getpositionlist-parameters">Parameters</h3>

|Name|In|Type|Required|Description|
|---|---|---|---|---|
|open|query|boolean|false|List opened positions.|
|closed|query|boolean|false|List closed positions.|
|all|query|boolean|false|List all positions.|

> Example responses

> 200 Response

```json
{
  "type": "object",
  "properties": {
    "positions": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "canceled": {
            "type": "boolean",
            "example": false
          },
          "canceled_ts": {
            "type": "string",
            "format": "date-time",
            "nullable": true,
            "example": null
          },
          "closed": {
            "type": "boolean",
            "example": true
          },
          "closed_ts": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "creation_ts": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "exit_price": {
            "type": "string",
            "example": "10010.0"
          },
          "funded": {
            "type": "boolean",
            "example": true
          },
          "funded_ts": {
            "type": "string",
            "format": "date-time",
            "nullable": true,
            "example": null
          },
          "id": {
            "type": "string",
            "example": "98"
          },
          "leverage": {
            "type": "string",
            "example": "50.0000"
          },
          "liquidation": {
            "type": "string",
            "example": "10194.0"
          },
          "margin": {
            "type": "string",
            "example": "136536"
          },
          "margin_wi": {
            "type": "string",
            "example": "closed"
          },
          "market_filled_ts": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          },
          "market_wi": {
            "type": "string",
            "example": "filled"
          },
          "payment_hash": {
            "type": "string",
            "nullable": true,
            "example": null
          },
          "pid": {
            "type": "string",
            "example": "249dc818-f8a5-4713-a3a3-8fe85f2e8969"
          },
          "pl": {
            "type": "string",
            "example": "-13640"
          },
          "price": {
            "type": "string",
            "example": "9990.0"
          },
          "quantity": {
            "type": "string",
            "example": "682"
          },
          "side": {
            "type": "string",
            "example": "s"
          },
          "sign": {
            "type": "string",
            "example": "-1"
          },
          "stoploss": {
            "type": "string",
            "nullable": true,
            "example": null
          },
          "stoploss_wi": {
            "type": "string",
            "nullable": true,
            "example": null
          },
          "takeprofit": {
            "type": "string",
            "nullable": true,
            "example": null
          },
          "takeprofit_wi": {
            "type": "string",
            "nullable": true,
            "example": null
          },
          "type": {
            "type": "string",
            "example": "m"
          },
          "uid": {
            "type": "string",
            "example": "d068f829-26e6-4743-b10d-ebb5a83b3624"
          },
          "user_id": {
            "type": "string",
            "nullable": true,
            "example": null
          },
          "wid": {
            "type": "string",
            "nullable": true,
            "example": null
          },
          "withdraw": {
            "type": "boolean",
            "example": false
          }
        }
      }
    }
  }
}
```

<h3 id="position_getpositionlist-responses">Responses</h3>

|Status|Meaning|Description|Schema|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|Positions history sucessfuly fetched.|Inline|
|400|[Bad Request](https://tools.ietf.org/html/rfc7231#section-6.5.1)|The request query and / or body does not fit the schema requirements. It can also be raised by parameters leading to unexpected behaviour / results.|None|
|401|[Unauthorized](https://tools.ietf.org/html/rfc7235#section-3.1)|Does not have user permissions.|None|

<h3 id="position_getpositionlist-responseschema">Response Schema</h3>

Status Code **200**

|Name|Type|Required|Restrictions|Description|
|---|---|---|---|---|
|» positions|[[#/paths/~1positions/get/responses/200/content/application~1json/schema/properties/positions/items](#schema#/paths/~1positions/get/responses/200/content/application~1json/schema/properties/positions/items)]|false|none|none|
|»» canceled|boolean|false|none|none|
|»» canceled_ts|string(date-time)¦null|false|none|none|
|»» closed|boolean|false|none|none|
|»» closed_ts|string(date-time)¦null|false|none|none|
|»» creation_ts|string(date-time)¦null|false|none|none|
|»» exit_price|string|false|none|none|
|»» funded|boolean|false|none|none|
|»» funded_ts|string(date-time)¦null|false|none|none|
|»» id|string|false|none|none|
|»» leverage|string|false|none|none|
|»» liquidation|string|false|none|none|
|»» margin|string|false|none|none|
|»» margin_wi|string|false|none|none|
|»» market_filled_ts|string(date-time)¦null|false|none|none|
|»» market_wi|string|false|none|none|
|»» payment_hash|string¦null|false|none|none|
|»» pid|string|false|none|none|
|»» pl|string|false|none|none|
|»» price|string|false|none|none|
|»» quantity|string|false|none|none|
|»» side|string|false|none|none|
|»» sign|string|false|none|none|
|»» stoploss|string¦null|false|none|none|
|»» stoploss_wi|string¦null|false|none|none|
|»» takeprofit|string¦null|false|none|none|
|»» takeprofit_wi|string¦null|false|none|none|
|»» type|string|false|none|none|
|»» uid|string|false|none|none|
|»» user_id|string¦null|false|none|none|
|»» wid|string¦null|false|none|none|
|»» withdraw|boolean|false|none|none|

<aside class="warning">
To perform this operation, you must be authenticated by means of one of the following methods:
jwtAuth ( Scopes: positions ), cookieAuth
</aside>

## Position_updatePosition

<a id="opIdPosition_updatePosition"></a>

`PUT /positions`

*Update position parameters.*

Allows user to modify `stoploss` and `takeprofit` parameters of an existing position.

> Body parameter

```json
{
  "oneOf": [
    {
      "type": "object",
      "required": [
        "pid",
        "takeprofit"
      ],
      "properties": {
        "pid": {
          "type": "string",
          "pattern": "^[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}$"
        },
        "takeprofit": {
          "type": "number",
          "format": "double",
          "minimum": 0,
          "multipleOf": 0.1
        }
      },
      "additionalProperties": false
    },
    {
      "type": "object",
      "required": [
        "pid",
        "stoploss"
      ],
      "properties": {
        "pid": {
          "type": "string",
          "pattern": "^[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}$"
        },
        "stoploss": {
          "type": "number",
          "format": "double",
          "minimum": 0,
          "multipleOf": 0.1
        }
      },
      "additionalProperties": false
    }
  ]
}
```

<h3 id="position_updateposition-parameters">Parameters</h3>

|Name|In|Type|Required|Description|
|---|---|---|---|---|
|body|body|any|true|Payload with everything needed to update a position accordingly.|

#### Detailed descriptions

**body**: Payload with everything needed to update a position accordingly.

**Pay attention : `stoploss` and `takeprofit` are mutually exclusives. This means you cannot send a request containing the two parameters at once.**

> Example responses

> 200 Response

```json
{
  "type": "object",
  "properties": {
    "success": {
      "type": "boolean"
    }
  }
}
```

<h3 id="position_updateposition-responses">Responses</h3>

|Status|Meaning|Description|Schema|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|Says whether or not the position was updated.|Inline|
|400|[Bad Request](https://tools.ietf.org/html/rfc7231#section-6.5.1)|The request query and / or body does not fit the schema requirements. It can also be raised by parameters leading to unexpected behaviour / results.|None|
|401|[Unauthorized](https://tools.ietf.org/html/rfc7235#section-3.1)|Does not have user permissions.|None|

<h3 id="position_updateposition-responseschema">Response Schema</h3>

Status Code **200**

|Name|Type|Required|Restrictions|Description|
|---|---|---|---|---|
|» success|boolean|false|none|none|

<aside class="warning">
To perform this operation, you must be authenticated by means of one of the following methods:
jwtAuth ( Scopes: positions ), cookieAuth
</aside>

## Position_createPosition

<a id="opIdPosition_createPosition"></a>

`POST /positions`

*Create a new position.*

Send the order form parameters to add a new position in database.

> Body parameter

```json
{
  "type": "m",
  "side": "b",
  "margin": 100000,
  "leverage": 25,
  "quantity": 500
}
```

<h3 id="position_createposition-parameters">Parameters</h3>

|Name|In|Type|Required|Description|
|---|---|---|---|---|
|body|body|object|false|Payload with all the information needed to setup a new position. if `side="l"`, the property `price` must be included in the request to know when the position should be filled.|
|» type|body|string|true|none|
|» side|body|string|true|none|
|» margin|body|integer(int32)|true|none|
|» leverage|body|number(double)|false|none|
|» quantity|body|integer|false|none|
|» takeprofit|body|number(double)|false|none|
|» stoploss|body|number(double)|false|none|
|» price|body|number(double)|false|none|

#### Enumerated Values

|Parameter|Value|
|---|---|
|» type|l|
|» type|m|
|» side|b|
|» side|s|

> Example responses

> 200 Response

```json
{
  "type": "object",
  "properties": {
    "canceled": {
      "type": "boolean",
      "example": false
    },
    "canceled_ts": {
      "type": "string",
      "format": "date-time",
      "nullable": true,
      "example": null
    },
    "closed": {
      "type": "boolean",
      "example": true
    },
    "closed_ts": {
      "type": "string",
      "format": "date-time",
      "nullable": true
    },
    "creation_ts": {
      "type": "string",
      "format": "date-time",
      "nullable": true
    },
    "exit_price": {
      "type": "string",
      "example": "10010.0"
    },
    "funded": {
      "type": "boolean",
      "example": true
    },
    "funded_ts": {
      "type": "string",
      "format": "date-time",
      "nullable": true,
      "example": null
    },
    "id": {
      "type": "string",
      "example": "98"
    },
    "leverage": {
      "type": "string",
      "example": "50.0000"
    },
    "liquidation": {
      "type": "string",
      "example": "10194.0"
    },
    "margin": {
      "type": "string",
      "example": "136536"
    },
    "margin_wi": {
      "type": "string",
      "example": "closed"
    },
    "market_filled_ts": {
      "type": "string",
      "format": "date-time",
      "nullable": true
    },
    "market_wi": {
      "type": "string",
      "example": "filled"
    },
    "payment_hash": {
      "type": "string",
      "nullable": true,
      "example": null
    },
    "pid": {
      "type": "string",
      "example": "249dc818-f8a5-4713-a3a3-8fe85f2e8969"
    },
    "pl": {
      "type": "string",
      "example": "-13640"
    },
    "price": {
      "type": "string",
      "example": "9990.0"
    },
    "quantity": {
      "type": "string",
      "example": "682"
    },
    "side": {
      "type": "string",
      "example": "s"
    },
    "sign": {
      "type": "string",
      "example": "-1"
    },
    "stoploss": {
      "type": "string",
      "nullable": true,
      "example": null
    },
    "stoploss_wi": {
      "type": "string",
      "nullable": true,
      "example": null
    },
    "takeprofit": {
      "type": "string",
      "nullable": true,
      "example": null
    },
    "takeprofit_wi": {
      "type": "string",
      "nullable": true,
      "example": null
    },
    "type": {
      "type": "string",
      "example": "m"
    },
    "uid": {
      "type": "string",
      "example": "d068f829-26e6-4743-b10d-ebb5a83b3624"
    },
    "user_id": {
      "type": "string",
      "nullable": true,
      "example": null
    },
    "wid": {
      "type": "string",
      "nullable": true,
      "example": null
    },
    "withdraw": {
      "type": "boolean",
      "example": false
    }
  }
}
```

<h3 id="position_createposition-responses">Responses</h3>

|Status|Meaning|Description|Schema|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|Position sucessfuly created.|Inline|
|400|[Bad Request](https://tools.ietf.org/html/rfc7231#section-6.5.1)|The request query and / or body does not fit the schema requirements. It can also be raised by parameters leading to unexpected behaviour / results.|None|
|401|[Unauthorized](https://tools.ietf.org/html/rfc7235#section-3.1)|Does not have user permissions.|None|

<h3 id="position_createposition-responseschema">Response Schema</h3>

Status Code **200**

|Name|Type|Required|Restrictions|Description|
|---|---|---|---|---|
|» canceled|boolean|false|none|none|
|» canceled_ts|string(date-time)¦null|false|none|none|
|» closed|boolean|false|none|none|
|» closed_ts|string(date-time)¦null|false|none|none|
|» creation_ts|string(date-time)¦null|false|none|none|
|» exit_price|string|false|none|none|
|» funded|boolean|false|none|none|
|» funded_ts|string(date-time)¦null|false|none|none|
|» id|string|false|none|none|
|» leverage|string|false|none|none|
|» liquidation|string|false|none|none|
|» margin|string|false|none|none|
|» margin_wi|string|false|none|none|
|» market_filled_ts|string(date-time)¦null|false|none|none|
|» market_wi|string|false|none|none|
|» payment_hash|string¦null|false|none|none|
|» pid|string|false|none|none|
|» pl|string|false|none|none|
|» price|string|false|none|none|
|» quantity|string|false|none|none|
|» side|string|false|none|none|
|» sign|string|false|none|none|
|» stoploss|string¦null|false|none|none|
|» stoploss_wi|string¦null|false|none|none|
|» takeprofit|string¦null|false|none|none|
|» takeprofit_wi|string¦null|false|none|none|
|» type|string|false|none|none|
|» uid|string|false|none|none|
|» user_id|string¦null|false|none|none|
|» wid|string¦null|false|none|none|
|» withdraw|boolean|false|none|none|

<aside class="warning">
To perform this operation, you must be authenticated by means of one of the following methods:
jwtAuth ( Scopes: positions ), cookieAuth
</aside>

## Position_closePosition

<a id="opIdPosition_closePosition"></a>

`DELETE /positions`

*Close a position.*

Ends a contract and update user balance according to the **[P&L](https://investinganswers.com/dictionary/p/profit-loss-pl-statement)**

<h3 id="position_closeposition-parameters">Parameters</h3>

|Name|In|Type|Required|Description|
|---|---|---|---|---|
|pid|query|string|false|ID of the position to close.|

> Example responses

> 200 Response

```json
{
  "type": "object",
  "properties": {
    "canceled": {
      "type": "boolean",
      "example": false
    },
    "canceled_ts": {
      "type": "string",
      "format": "date-time",
      "nullable": true,
      "example": null
    },
    "closed": {
      "type": "boolean",
      "example": true
    },
    "closed_ts": {
      "type": "string",
      "format": "date-time",
      "nullable": true
    },
    "creation_ts": {
      "type": "string",
      "format": "date-time",
      "nullable": true
    },
    "exit_price": {
      "type": "string",
      "example": "10010.0"
    },
    "funded": {
      "type": "boolean",
      "example": true
    },
    "funded_ts": {
      "type": "string",
      "format": "date-time",
      "nullable": true,
      "example": null
    },
    "id": {
      "type": "string",
      "example": "98"
    },
    "leverage": {
      "type": "string",
      "example": "50.0000"
    },
    "liquidation": {
      "type": "string",
      "example": "10194.0"
    },
    "margin": {
      "type": "string",
      "example": "136536"
    },
    "margin_wi": {
      "type": "string",
      "example": "closed"
    },
    "market_filled_ts": {
      "type": "string",
      "format": "date-time",
      "nullable": true
    },
    "market_wi": {
      "type": "string",
      "example": "filled"
    },
    "payment_hash": {
      "type": "string",
      "nullable": true,
      "example": null
    },
    "pid": {
      "type": "string",
      "example": "249dc818-f8a5-4713-a3a3-8fe85f2e8969"
    },
    "pl": {
      "type": "string",
      "example": "-13640"
    },
    "price": {
      "type": "string",
      "example": "9990.0"
    },
    "quantity": {
      "type": "string",
      "example": "682"
    },
    "side": {
      "type": "string",
      "example": "s"
    },
    "sign": {
      "type": "string",
      "example": "-1"
    },
    "stoploss": {
      "type": "string",
      "nullable": true,
      "example": null
    },
    "stoploss_wi": {
      "type": "string",
      "nullable": true,
      "example": null
    },
    "takeprofit": {
      "type": "string",
      "nullable": true,
      "example": null
    },
    "takeprofit_wi": {
      "type": "string",
      "nullable": true,
      "example": null
    },
    "type": {
      "type": "string",
      "example": "m"
    },
    "uid": {
      "type": "string",
      "example": "d068f829-26e6-4743-b10d-ebb5a83b3624"
    },
    "user_id": {
      "type": "string",
      "nullable": true,
      "example": null
    },
    "wid": {
      "type": "string",
      "nullable": true,
      "example": null
    },
    "withdraw": {
      "type": "boolean",
      "example": false
    }
  }
}
```

<h3 id="position_closeposition-responses">Responses</h3>

|Status|Meaning|Description|Schema|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|Sucessfuly closed position.|Inline|
|400|[Bad Request](https://tools.ietf.org/html/rfc7231#section-6.5.1)|The request query and / or body does not fit the schema requirements. It can also be raised by parameters leading to unexpected behaviour / results.|None|
|401|[Unauthorized](https://tools.ietf.org/html/rfc7235#section-3.1)|Does not have user permissions.|None|

<h3 id="position_closeposition-responseschema">Response Schema</h3>

Status Code **200**

|Name|Type|Required|Restrictions|Description|
|---|---|---|---|---|
|» canceled|boolean|false|none|none|
|» canceled_ts|string(date-time)¦null|false|none|none|
|» closed|boolean|false|none|none|
|» closed_ts|string(date-time)¦null|false|none|none|
|» creation_ts|string(date-time)¦null|false|none|none|
|» exit_price|string|false|none|none|
|» funded|boolean|false|none|none|
|» funded_ts|string(date-time)¦null|false|none|none|
|» id|string|false|none|none|
|» leverage|string|false|none|none|
|» liquidation|string|false|none|none|
|» margin|string|false|none|none|
|» margin_wi|string|false|none|none|
|» market_filled_ts|string(date-time)¦null|false|none|none|
|» market_wi|string|false|none|none|
|» payment_hash|string¦null|false|none|none|
|» pid|string|false|none|none|
|» pl|string|false|none|none|
|» price|string|false|none|none|
|» quantity|string|false|none|none|
|» side|string|false|none|none|
|» sign|string|false|none|none|
|» stoploss|string¦null|false|none|none|
|» stoploss_wi|string¦null|false|none|none|
|» takeprofit|string¦null|false|none|none|
|» takeprofit_wi|string¦null|false|none|none|
|» type|string|false|none|none|
|» uid|string|false|none|none|
|» user_id|string¦null|false|none|none|
|» wid|string¦null|false|none|none|
|» withdraw|boolean|false|none|none|

<aside class="warning">
To perform this operation, you must be authenticated by means of one of the following methods:
jwtAuth ( Scopes: positions ), cookieAuth
</aside>

## Position_cancelPosition

<a id="opIdPosition_cancelPosition"></a>

`POST /positions/cancel`

Cancel the position linked to the given `pid`.**Only works on positions that are not currently filled**.

> Body parameter

```json
{
  "type": "object",
  "required": [
    "pid"
  ],
  "properties": {
    "pid": {
      "type": "string",
      "pattern": "^[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}$",
      "example": "b87eef8a-52ab-2fea-1adc-c41fba870b0f"
    }
  }
}
```

<h3 id="position_cancelposition-parameters">Parameters</h3>

|Name|In|Type|Required|Description|
|---|---|---|---|---|
|body|body|object|true|Payload containing the position id that will be cancelled.|
|» pid|body|string|true|none|

<h3 id="position_cancelposition-responses">Responses</h3>

|Status|Meaning|Description|Schema|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|Successfully cancelled the given position.|None|
|400|[Bad Request](https://tools.ietf.org/html/rfc7231#section-6.5.1)|The request query and / or body does not fit the schema requirements. It can also be raised by parameters leading to unexpected behaviour / results.|None|
|401|[Unauthorized](https://tools.ietf.org/html/rfc7235#section-3.1)|Does not have user permissions.|None|

<aside class="warning">
To perform this operation, you must be authenticated by means of one of the following methods:
jwtAuth ( Scopes: positions ), cookieAuth
</aside>

<h1 id="ln-markets-api-user">User</h1>

Interactions with the website

## User_getUser

<a id="opIdUser_getUser"></a>

`GET /user`

*Retrieves user informations.*

Fetches UID, username, account type and current balance.

> Example responses

> 200 Response

```json
{
  "type": "object",
  "properties": {
    "uid": {
      "type": "string",
      "example": "d068f829-26e6-4743-b10d-ebb5a83b3624"
    },
    "balance": {
      "type": "string",
      "example": "361086"
    },
    "username": {
      "type": "string",
      "example": "Test-user"
    },
    "account_type": {
      "type": "string",
      "example": "credentials"
    }
  }
}
```

<h3 id="user_getuser-responses">Responses</h3>

|Status|Meaning|Description|Schema|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|User found and informations are fetched.|Inline|
|401|[Unauthorized](https://tools.ietf.org/html/rfc7235#section-3.1)|Does not have user permissions.|None|

<h3 id="user_getuser-responseschema">Response Schema</h3>

Status Code **200**

|Name|Type|Required|Restrictions|Description|
|---|---|---|---|---|
|» uid|string|false|none|none|
|» balance|string|false|none|none|
|» username|string|false|none|none|
|» account_type|string|false|none|none|

<aside class="warning">
To perform this operation, you must be authenticated by means of one of the following methods:
jwtAuth ( Scopes: user ), cookieAuth
</aside>

## User_updateUser

<a id="opIdUser_updateUser"></a>

`PUT /user`

*Update user informations.*

Update the current password to the requested one.

> Body parameter

```json
{
  "type": "object",
  "required": [
    "previousPassword",
    "newPassword"
  ],
  "properties": {
    "previousPassword": {
      "type": "string",
      "format": "password",
      "pattern": "^(?=\\S)(?=.*\\d)(?=.*[a-z])(?=.*[A-Z]).\\S{7,63}",
      "minLength": 8,
      "maxLength": 64,
      "example": "Password01"
    },
    "newPassword": {
      "type": "string",
      "format": "password",
      "pattern": "^(?=\\S)(?=.*\\d)(?=.*[a-z])(?=.*[A-Z]).\\S{7,63}",
      "minLength": 8,
      "maxLength": 64,
      "example": "Password02"
    }
  }
}
```

<h3 id="user_updateuser-parameters">Parameters</h3>

|Name|In|Type|Required|Description|
|---|---|---|---|---|
|body|body|object|true|Payload containing user credentials.|
|» previousPassword|body|string(password)|true|none|
|» newPassword|body|string(password)|true|none|

<h3 id="user_updateuser-responses">Responses</h3>

|Status|Meaning|Description|Schema|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|Password successfuly.|None|
|400|[Bad Request](https://tools.ietf.org/html/rfc7231#section-6.5.1)|The request query and / or body does not fit the schema requirements. It can also be raised by parameters leading to unexpected behaviour / results.|None|
|401|[Unauthorized](https://tools.ietf.org/html/rfc7235#section-3.1)|Does not have user permissions.|None|

<aside class="warning">
To perform this operation, you must be authenticated by means of one of the following methods:
jwtAuth ( Scopes: user ), cookieAuth
</aside>

## User_deposit

<a id="opIdUser_deposit"></a>

`POST /user/deposit`

Move funds from user wallet to the **[Lightning channel](https://medium.com/suredbits/lightning-101-what-are-lightning-channels-cfb80f440298)** with LN-Markets.

> Body parameter

```json
{
  "type": "object",
  "required": [
    "amount"
  ],
  "properties": {
    "amount": {
      "type": "integer",
      "minimum": 100,
      "maximum": 1000000,
      "example": 10000
    },
    "unit": {
      "type": "string",
      "pattern": "^[a-zA-Z0-9]+$",
      "default": "sat",
      "example": "sat"
    }
  }
}
```

<h3 id="user_deposit-parameters">Parameters</h3>

|Name|In|Type|Required|Description|
|---|---|---|---|---|
|body|body|object|true|Payload that countains all informations initiale a new deposit promise.|
|» amount|body|integer|true|none|
|» unit|body|string|false|none|

> Example responses

> 200 Response

```json
{
  "type": "object",
  "properties": {
    "paymentRequest": {
      "type": "string",
      "example": "lntb100u1p0jrfz0pp5q0ntrkf052dvep8w6vf0z77rek3fz8xm6c2yau4zhy7f4mzauqgsdzcf3hy6ctjddjhgueqg3jhqmmnd96zqgmxxquryvesvv6z6dehv43z6drpvycj6wfevs6j6dmyxcunxefcxccxxvn9cqzpgxqzpdsp5z40mxcrfqtsxf55u9ju3lvqdw36htsjh4xl2ujrzdff3953fg2yq9qy9qsqv7gfvp0tryme3e8r5xfrpg39j645302fkggps4h5j0aj708lzdgh2dq3pdz6lqazgvkt3wm7qq20vcff46vu5549m3v2d6h0uw3sjacqrkjqcv"
    },
    "expiry": {
      "type": "integer",
      "example": 45
    }
  }
}
```

<h3 id="user_deposit-responses">Responses</h3>

|Status|Meaning|Description|Schema|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|New deposit entry in database waiting for payment. Using `paymentRequest` afterwards, user will confirm the deposit and funds will be added to his account.|Inline|
|400|[Bad Request](https://tools.ietf.org/html/rfc7231#section-6.5.1)|The request query and / or body does not fit the schema requirements. It can also be raised by parameters leading to unexpected behaviour / results.|None|
|401|[Unauthorized](https://tools.ietf.org/html/rfc7235#section-3.1)|Does not have user permissions.|None|

<h3 id="user_deposit-responseschema">Response Schema</h3>

Status Code **200**

|Name|Type|Required|Restrictions|Description|
|---|---|---|---|---|
|» paymentRequest|string|false|none|none|
|» expiry|integer|false|none|none|

<aside class="warning">
To perform this operation, you must be authenticated by means of one of the following methods:
jwtAuth ( Scopes: deposit ), cookieAuth
</aside>

## User_getHistory

<a id="opIdUser_getHistory"></a>

`GET /user/history`

*(Rework API Response - Object with Array of Objects)*

Retrieves all funds that either went in or out of the **[Lightning channel](https://medium.com/suredbits/lightning-101-what-are-lightning-channels-cfb80f440298)** between user and LN-Markets.

<h3 id="user_gethistory-parameters">Parameters</h3>

|Name|In|Type|Required|Description|
|---|---|---|---|---|
|type|query|string|true|Which kind of transactions will be fetched.|

#### Enumerated Values

|Parameter|Value|
|---|---|
|type|withdraw|
|type|deposit|

> Example responses

> 200 Response

```json
{
  "type": "object",
  "properties": {
    "transaction": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "amount": {
            "type": "string",
            "example": "99400"
          },
          "creation_ts": {
            "type": "string",
            "format": "date-time"
          },
          "details": {
            "type": "string",
            "nullable": true,
            "example": null
          },
          "did": {
            "type": "string",
            "example": "269157f3-d4a1-4493-afcb-5e8fdaa49288"
          },
          "fail": {
            "type": "boolean",
            "example": false
          },
          "fail_reason": {
            "type": "string",
            "nullable": true,
            "example": null
          },
          "fail_ts": {
            "type": "string",
            "format": "date-time",
            "nullable": true,
            "example": null
          },
          "payment_hash": {
            "type": "string",
            "example": "33f45c13c7ddcae46c6732414552893ca599f9399c62ffc2cfae209e8b17c5c3"
          },
          "success": {
            "type": "boolean"
          },
          "sucess_ts": {
            "type": "string",
            "format": "date-time",
            "nullable": true,
            "example": null
          },
          "uid": {
            "type": "string",
            "example": "d068f829-26e6-4743-b10d-ebb5a83b3624"
          }
        }
      }
    }
  }
}
```

<h3 id="user_gethistory-responses">Responses</h3>

|Status|Meaning|Description|Schema|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|History sucessfully pulled.|Inline|
|400|[Bad Request](https://tools.ietf.org/html/rfc7231#section-6.5.1)|The request query and / or body does not fit the schema requirements. It can also be raised by parameters leading to unexpected behaviour / results.|None|
|401|[Unauthorized](https://tools.ietf.org/html/rfc7235#section-3.1)|Does not have user permissions.|None|

<h3 id="user_gethistory-responseschema">Response Schema</h3>

Status Code **200**

|Name|Type|Required|Restrictions|Description|
|---|---|---|---|---|
|» transaction|[object]|false|none|none|
|»» amount|string|false|none|none|
|»» creation_ts|string(date-time)|false|none|none|
|»» details|string¦null|false|none|none|
|»» did|string|false|none|none|
|»» fail|boolean|false|none|none|
|»» fail_reason|string¦null|false|none|none|
|»» fail_ts|string(date-time)¦null|false|none|none|
|»» payment_hash|string|false|none|none|
|»» success|boolean|false|none|none|
|»» sucess_ts|string(date-time)¦null|false|none|none|
|»» uid|string|false|none|none|

<aside class="warning">
To perform this operation, you must be authenticated by means of one of the following methods:
jwtAuth ( Scopes: user ), cookieAuth
</aside>

## User_GetJWTList

<a id="opIdUser_GetJWTList"></a>

`GET /user/jwt`

*Lists active JSON Web Tokens.*

Retrieves the list of active JSON Web Token user currently holds.

> Example responses

> 200 Response

```json
{
  "type": "array",
  "items": {
    "type": "object",
    "properties": {
      "aud": {
        "type": "array",
        "items": {
          "type": "string",
          "enum": [
            "position",
            "withdraw",
            "deposit",
            "user"
          ]
        },
        "uniqueItems": true,
        "maxItems": 4
      },
      "exp": {
        "type": "string",
        "format": "date-time"
      },
      "iat": {
        "type": "string",
        "format": "date-time"
      },
      "jti": {
        "type": "string",
        "example": "ckea35me20019r8u36374585f"
      },
      "revoked": {
        "type": "boolean"
      }
    }
  }
}
```

<h3 id="user_getjwtlist-responses">Responses</h3>

|Status|Meaning|Description|Schema|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|Token list retrieved.|Inline|
|401|[Unauthorized](https://tools.ietf.org/html/rfc7235#section-3.1)|Does not have user permissions.|None|

<h3 id="user_getjwtlist-responseschema">Response Schema</h3>

Status Code **200**

|Name|Type|Required|Restrictions|Description|
|---|---|---|---|---|
|» aud|[string]|false|none|none|
|» exp|string(date-time)|false|none|none|
|» iat|string(date-time)|false|none|none|
|» jti|string|false|none|none|
|» revoked|boolean|false|none|none|

<aside class="warning">
To perform this operation, you must be authenticated by means of one of the following methods:
cookieAuth
</aside>

## User_RevokeJWT

<a id="opIdUser_RevokeJWT"></a>

`DELETE /user/jwt`

*Revoked an active JSON Web Toekn.*

Using the `jti` parameter, identifies and revoke usage of a given JWT.

<h3 id="user_revokejwt-parameters">Parameters</h3>

|Name|In|Type|Required|Description|
|---|---|---|---|---|
|jti|query|string|false|Token unique identifier.|

<h3 id="user_revokejwt-responses">Responses</h3>

|Status|Meaning|Description|Schema|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|Token successfuly revoked.|None|
|400|[Bad Request](https://tools.ietf.org/html/rfc7231#section-6.5.1)|The request query and / or body does not fit the schema requirements. It can also be raised by parameters leading to unexpected behaviour / results.|None|
|401|[Unauthorized](https://tools.ietf.org/html/rfc7235#section-3.1)|Does not have user permissions.|None|

<aside class="warning">
To perform this operation, you must be authenticated by means of one of the following methods:
cookieAuth
</aside>

## User_CreateJWT

<a id="opIdUser_CreateJWT"></a>

`POST /user/jwt`

*Create a new JSON Web Token.*

Using the given scopes, allow the token bearer to get access to different parts of the public API.

> Body parameter

```json
{
  "type": "object",
  "required": [
    "scopes",
    "expiry"
  ],
  "properties": {
    "scopes": {
      "type": "array",
      "items": {
        "type": "string",
        "enum": [
          "deposit",
          "withdraw",
          "positions",
          "user"
        ],
        "example": [
          "deposit",
          "withdraw"
        ]
      },
      "uniqueItems": true,
      "maxItems": 4
    },
    "expiry": {
      "type": "integer",
      "format": "int32",
      "minimum": 0,
      "example": 86400
    }
  }
}
```

<h3 id="user_createjwt-parameters">Parameters</h3>

|Name|In|Type|Required|Description|
|---|---|---|---|---|
|body|body|object|true|Scopes of authorization that the token will grant to the bearer.|
|» scopes|body|[string]|true|none|
|» expiry|body|integer(int32)|true|none|

#### Enumerated Values

|Parameter|Value|
|---|---|
|» scopes|deposit|
|» scopes|withdraw|
|» scopes|positions|
|» scopes|user|

> Example responses

> 200 Response

```json
{
  "properties": {
    "signature": {
      "type": "string",
      "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIiLCJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjMwMDAiLCJpYXQiOjE1OTgwNTg2NDQsInNjb3BlcyI6WyJ3aXRoZHJhdyIsImRlcG9zaXQiXX0.xJ3f5eMeRiN0eSzo3IDviny9B9v_-bLg4t_EWmXFBxc"
    }
  }
}
```

<h3 id="user_createjwt-responses">Responses</h3>

|Status|Meaning|Description|Schema|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|Token successfuly created, its Base64URL encoded signature is returned for future use.|Inline|
|400|[Bad Request](https://tools.ietf.org/html/rfc7231#section-6.5.1)|The request query and / or body does not fit the schema requirements. It can also be raised by parameters leading to unexpected behaviour / results.|None|
|401|[Unauthorized](https://tools.ietf.org/html/rfc7235#section-3.1)|Does not have user permissions.|None|

<h3 id="user_createjwt-responseschema">Response Schema</h3>

Status Code **200**

|Name|Type|Required|Restrictions|Description|
|---|---|---|---|---|
|» signature|string|false|none|none|

<aside class="warning">
To perform this operation, you must be authenticated by means of one of the following methods:
cookieAuth
</aside>

## User_withdraw

<a id="opIdUser_withdraw"></a>

`POST /user/withdraw`

Move funds from the **[Lightning channel](https://medium.com/suredbits/lightning-101-what-are-lightning-channels-cfb80f440298)** with LN-Markets to user wallet by using an invoice directly.

> Body parameter

```json
{
  "type": "object",
  "required": [
    "amount",
    "invoice"
  ],
  "properties": {
    "amount": {
      "type": "integer",
      "minimum": 1000,
      "example": 10000
    },
    "unit": {
      "type": "string",
      "pattern": "^[a-zA-Z0-9]+$",
      "example": "sat"
    },
    "invoice": {
      "type": "string",
      "pattern": "^[a-zA-Z0-9]+$",
      "example": "lntb100u1p0jr0ykpp5ldx3un8ym6z0uwjxd083mp2rcr04d2dv0fkx729ajs62pq9pfjqqdql23jhxapdwa5hg6rywfshwttjda6hgegcqzpgxq92fjuqsp5m6q0fzynu2qr624mzjc285duurhccmkfg94mcdctc0p9s7qkrq8q9qy9qsqp862cjznpey5r76e7amhlpmhwn2c7xvke59srhv0xf75m4ksjm4hzn8y9xy0zs5ec6gxmsr8gj4q23w8ped32llscjcneyjz2afeapqpu4gamz"
    }
  }
}
```

<h3 id="user_withdraw-parameters">Parameters</h3>

|Name|In|Type|Required|Description|
|---|---|---|---|---|
|body|body|object|true|Payload that countains all informations to initiate a new withdraw.|
|» amount|body|integer|true|none|
|» unit|body|string|false|none|
|» invoice|body|string|true|none|

> Example responses

> 200 Response

```json
{
  "type": "object",
  "properties": {
    "amount": {
      "type": "integer",
      "example": 10000
    },
    "paymentsecret": {
      "type": "string",
      "example": "1b84c9852e929f99700b6cbabc4ca9d1593afc3736938b348c4d3d143e418bd4"
    },
    "wid": {
      "type": "string",
      "example": "3fcbd8b7-c35b-4e83-87bc-111d5bd186b7"
    },
    "paymenthash": {
      "type": "string",
      "example": "fb4d1e4ce4de84fe3a466bcf1d8543c0df56a9ac7a6c6f28bd9434a080a14c80"
    }
  }
}
```

<h3 id="user_withdraw-responses">Responses</h3>

|Status|Meaning|Description|Schema|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|Funds are removed from user account and added to user wallet.|Inline|
|400|[Bad Request](https://tools.ietf.org/html/rfc7231#section-6.5.1)|The request query and / or body does not fit the schema requirements. It can also be raised by parameters leading to unexpected behaviour / results.|None|
|401|[Unauthorized](https://tools.ietf.org/html/rfc7235#section-3.1)|Does not have user permissions.|None|

<h3 id="user_withdraw-responseschema">Response Schema</h3>

Status Code **200**

|Name|Type|Required|Restrictions|Description|
|---|---|---|---|---|
|» amount|integer|false|none|none|
|» paymentsecret|string|false|none|none|
|» wid|string|false|none|none|
|» paymenthash|string|false|none|none|

<aside class="warning">
To perform this operation, you must be authenticated by means of one of the following methods:
jwtAuth ( Scopes: withdraw ), cookieAuth
</aside>

## User_withdrawLnurl

<a id="opIdUser_withdrawLnurl"></a>

`POST /user/withdraw/lnurl`

Create a LNURL Withdraw.

> Body parameter

```json
{
  "type": "object",
  "required": [
    "amount"
  ],
  "properties": {
    "amount": {
      "type": "integer",
      "minimum": 1000,
      "example": 10000
    },
    "unit": {
      "type": "string",
      "enum": [
        "sat",
        "msat"
      ],
      "default": "sat",
      "example": "sat"
    }
  }
}
```

<h3 id="user_withdrawlnurl-parameters">Parameters</h3>

|Name|In|Type|Required|Description|
|---|---|---|---|---|
|body|body|object|true|Amount the user want to withdraw.|
|» amount|body|integer|true|none|
|» unit|body|string|false|none|

#### Enumerated Values

|Parameter|Value|
|---|---|
|» unit|sat|
|» unit|msat|

> Example responses

> 200 Response

```json
{
  "type": "object",
  "properties": {
    "lnurl": {
      "type": "string",
      "example": "LNURL1DP68GURN8GHJ7UM9WFMXJCM99E3K7MF0V9CXJ0M385EKVCENXC6R2C35XVUKXEFCV5MKVV34X5EKZD3EV56NYD3HXQURZEPEXEJXXEPNXSCRVWFNV9NXZCN9XQ6XYEFHVGCXXCMYXYMNSERXFQ5FNS"
    }
  }
}
```

<h3 id="user_withdrawlnurl-responses">Responses</h3>

|Status|Meaning|Description|Schema|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|Bech32 encoded string|Inline|
|400|[Bad Request](https://tools.ietf.org/html/rfc7231#section-6.5.1)|The request query and / or body does not fit the schema requirements. It can also be raised by parameters leading to unexpected behaviour / results.|None|
|401|[Unauthorized](https://tools.ietf.org/html/rfc7235#section-3.1)|Does not have user permissions.|None|

<h3 id="user_withdrawlnurl-responseschema">Response Schema</h3>

Status Code **200**

|Name|Type|Required|Restrictions|Description|
|---|---|---|---|---|
|» lnurl|string|false|none|none|

<aside class="warning">
To perform this operation, you must be authenticated by means of one of the following methods:
jwtAuth ( Scopes: withdraw ), cookieAuth
</aside>

## User_logout

<a id="opIdUser_logout"></a>

`POST /user/logout`

Delete session cookie.

<h3 id="user_logout-responses">Responses</h3>

|Status|Meaning|Description|Schema|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|Sucessfuly logged out.|None|

<aside class="success">
This operation does not require authentication
</aside>

<h1 id="ln-markets-api-state">State</h1>

Services availability

## State_apiState

<a id="opIdState_apiState"></a>

`GET /state/api`

*module statuses.*

Shows available interactions with the platform.

> Example responses

> 200 Response

```json
{
  "type": "object",
  "properties": {
    "withdraw": {
      "type": "boolean"
    },
    "newposition": {
      "type": "boolean"
    },
    "accountCreation": {
      "type": "boolean"
    }
  }
}
```

<h3 id="state_apistate-responses">Responses</h3>

|Status|Meaning|Description|Schema|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|Services are running (not necessarly available).|Inline|

<h3 id="state_apistate-responseschema">Response Schema</h3>

Status Code **200**

|Name|Type|Required|Restrictions|Description|
|---|---|---|---|---|
|» withdraw|boolean|false|none|none|
|» newposition|boolean|false|none|none|
|» accountCreation|boolean|false|none|none|

<aside class="success">
This operation does not require authentication
</aside>

## State_nodeState

<a id="opIdState_nodeState"></a>

`GET /state/node`

*Lightning node status.*

Shows informations about the node.

> Example responses

> 200 Response

```json
{
  "type": "object",
  "properties": {
    "uri": {
      "type": "string",
      "example": "03375e4d3218dde2524feecaab7dc3a11a6ea186ff86c3cf2722e7237abc0d6d68@34.192.102.161:9735"
    },
    "alias": {
      "type": "string",
      "example": "Localnode"
    },
    "pubkey": {
      "type": "string",
      "example": "03375ead3218dd78024fe0caab7dc3a11a6ea186be86c3cf2722e7237abc0d6dc8"
    }
  }
}
```

<h3 id="state_nodestate-responses">Responses</h3>

|Status|Meaning|Description|Schema|
|---|---|---|---|
|200|[OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)|The Lightning node is online.|Inline|

<h3 id="state_nodestate-responseschema">Response Schema</h3>

Status Code **200**

|Name|Type|Required|Restrictions|Description|
|---|---|---|---|---|
|» uri|string|false|none|none|
|» alias|string|false|none|none|
|» pubkey|string|false|none|none|

<aside class="success">
This operation does not require authentication
</aside>

